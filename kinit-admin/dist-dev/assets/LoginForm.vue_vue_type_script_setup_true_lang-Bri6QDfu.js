var P=(a,h,n)=>new Promise((i,r)=>{var g=l=>{try{c(n.next(l))}catch(t){r(t)}},v=l=>{try{c(n.throw(l))}catch(t){r(t)}},c=l=>l.done?i(l.value):Promise.resolve(l.value).then(g,v);c((n=n.apply(a,h)).next())});import{u as B,F as D}from"./useForm-B2dmd6BN.js";import{e as M,u as O,t as k,I as u,g as N,d as J}from"./index-DY4Ks39X.js";import{l as T,aB as U,a as y,J as $,O as o,P as _,b as G,m as H,S as K,u as C,y as Q}from"./vue-chunks-DM5Q6aJS.js";import{u as W}from"./useValidator-B6tBWFkI.js";import{x as X,q as Y}from"./element-plus-D9n4Ar5m.js";function I(a){return typeof a=="function"||Object.prototype.toString.call(a)==="[object Object]"&&!Q(a)}const p="var(--el-color-primary)",m=30,f="#999",re=T({__name:"LoginForm",emits:["to-telephone"],setup(a,{emit:h}){const n=h,{required:i}=W(),r=M(),g=O(),{currentRoute:v,addRoute:c,push:l}=U(),{t}=J(),x=y(!1),S={telephone:[i()],method:[i()],password:[i()]},z=$([{field:"title",colProps:{span:24},formItemProps:{slots:{default:()=>o("h2",{class:"text-2xl font-bold text-center w-[100%]"},[t("login.login")])}}},{field:"telephone",label:t("login.telephone"),value:"",component:"Input",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:t("login.telephonePlaceholder"),maxlength:11}},{field:"password",label:t("login.password"),value:"",component:"InputPassword",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:t("login.passwordPlaceholder")}},{field:"method",label:"登录类型",value:"0",component:"Input",hidden:!0},{field:"tool",colProps:{span:24},formItemProps:{slots:{default:()=>{let e;return o(_,null,[o("div",{class:"flex justify-between items-center w-[100%]"},[o(X,{modelValue:x.value,"onUpdate:modelValue":s=>x.value=s,label:t("login.remember"),size:"small"},null),o(Y,{type:"primary",underline:!1},I(e=t("login.forgetPassword"))?e:{default:()=>[e]})])])}}}},{field:"login",colProps:{span:24},formItemProps:{slots:{default:()=>{let e,s;return o(_,null,[o("div",{class:"w-[100%]"},[o(k,{loading:d.value,type:"primary",class:"w-[100%]",onClick:V},I(e=t("login.login"))?e:{default:()=>[e]})]),o("div",{class:"w-[100%] mt-15px"},[o(k,{class:"w-[100%]",onClick:A},I(s=t("login.smsLogin"))?s:{default:()=>[s]})])])}}}},{field:"other",component:"Divider",label:t("login.otherLogin"),componentProps:{contentPosition:"center"}},{field:"otherIcon",colProps:{span:24},formItemProps:{slots:{default:()=>o(_,null,[o("div",{class:"flex justify-between w-[100%]"},[o(u,{icon:"ant-design:github-filled",size:m,class:"cursor-pointer ant-icon",color:f,hoverColor:p},null),o(u,{icon:"ant-design:wechat-filled",size:m,class:"cursor-pointer ant-icon",color:f,hoverColor:p},null),o(u,{icon:"ant-design:alipay-circle-filled",size:m,color:f,hoverColor:p,class:"cursor-pointer ant-icon"},null),o(u,{icon:"ant-design:weibo-circle-filled",size:m,color:f,hoverColor:p,class:"cursor-pointer ant-icon"},null)])])}}}]),{formRegister:F,formMethods:j}=B(),{getFormData:E,getElFormExpose:L}=j,d=y(!1),R=y("");G(()=>v.value,e=>{var s;R.value=(s=e==null?void 0:e.query)==null?void 0:s.redirect},{immediate:!0});const V=()=>P(this,null,function*(){const e=yield L();if(yield e==null?void 0:e.validate()){d.value=!0;const w=yield E();try{const b=yield g.login(w);b?b.data.is_reset_password?q():l({path:"/reset/password"}):d.value=!1}catch(b){d.value=!1}}}),q=()=>P(this,null,function*(){const e=yield N();if(e){const s=e.data||[];yield r.generateRoutes(s).catch(()=>{}),r.getAddRouters.forEach(w=>{c(w)}),r.setIsAddRouters(!0),l({path:R.value||r.addRouters[0].path})}}),A=()=>{n("to-telephone")};return(e,s)=>(H(),K(C(D),{schema:z,rules:S,"label-position":"top","hide-required-asterisk":"",size:"large",class:"dark:border-1 dark:border-[var(--el-border-color)] dark:border-solid",onRegister:C(F)},null,8,["schema","onRegister"]))}});export{re as _};
//# sourceMappingURL=LoginForm.vue_vue_type_script_setup_true_lang-Bri6QDfu.js.map
