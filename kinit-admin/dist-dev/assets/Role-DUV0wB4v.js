var le=Object.defineProperty;var T=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var F=(u,s,o)=>s in u?le(u,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):u[s]=o,I=(u,s)=>{for(var o in s||(s={}))oe.call(s,o)&&F(u,o,s[o]);if(T)for(var o of T(s))se.call(s,o)&&F(u,o,s[o]);return u};var m=(u,s,o)=>new Promise((y,R)=>{var A=i=>{try{_(o.next(i))}catch(c){R(c)}},D=i=>{try{_(o.throw(i))}catch(c){R(c)}},_=i=>i.done?y(i.value):Promise.resolve(i.value).then(A,D);_((o=o.apply(u,s)).next())});import{l as ne,a as r,J as U,O as l,u as t,P as b,_ as k,$ as z,ar as V,V as g,ah as G,m as N,p as ie,R as d,B as j,S as re,W as J}from"./vue-chunks-DM5Q6aJS.js";import{g as W,a as ue,d as de,b as ce,p as me}from"./role-DPZl-TmD.js";import{u as pe,_ as fe}from"./Table.vue_vue_type_script_lang-DvOqtju8.js";import{d as ge,t as v}from"./index-DY4Ks39X.js";import{_ as ve}from"./Search.vue_vue_type_script_setup_true_lang-Dp5jFa9Y.js";import{_ as _e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-R-yJIw7t.js";import{_ as we}from"./Write.vue_vue_type_script_setup_true_lang-CbynnG_a.js";import he from"./AuthManage-D_AFcdcW.js";import{_ as be}from"./Dialog.vue_vue_type_style_index_0_lang-zBp3wG0q.js";import{s as ye}from"./dict-DJyIMlYA.js";import{u as Re}from"./dict-BebjR_rx.js";import{z as q}from"./element-plus-D9n4Ar5m.js";import"./useForm-B2dmd6BN.js";import"./style.css_vue_type_style_index_0_src_true_lang-nZXfjKm1.js";import"./wang-editor-CLgHiBvf.js";import"./_Uint8Array-DKqHwQen.js";import"./useIcon-Ca7c3xG3.js";import"./useValidator-B6tBWFkI.js";import"./menu-CbYmW6R2.js";import"./dept-iu1_v8bR.js";import"./tree-Db49nok3.js";import"./dict-DpEfB3FK.js";const qe=ne({name:"AuthRole",__name:"Role",setup(u){const{t:s}=ge(),{tableRegister:o,tableState:y,tableMethods:R}=pe({fetchDataApi:()=>m(this,null,function*(){const{pageSize:a,currentPage:e}=y,n=yield ue(I({page:t(e),limit:t(a)},t(E)));return{list:n.data||[],total:n.count||0}}),fetchDelApi:a=>m(this,null,function*(){return(yield de(a)).code===200})}),{dataList:A,loading:D,total:_,pageSize:i,currentPage:c}=y,{getList:w,delList:H}=R;let $=r([]);m(this,null,function*(){const e=yield Re().getDictObj(["sys_vadmin_data_range"]);$.value=e.sys_vadmin_data_range});const K=U([{field:"id",label:"角色编号",show:!1,disabled:!1},{field:"name",label:"角色名称",show:!0,disabled:!0},{field:"role_key",label:"权限字符",show:!0},{field:"data_range",label:"数据范围",show:!0,slots:{default:a=>{const e=a.row;return l(b,null,[l("div",null,[ye(t($),e.data_range.toString())])])}}},{field:"order",label:"显示顺序",show:!0},{field:"disabled",label:"角色状态",show:!0,slots:{default:a=>{const e=a.row;return l(b,null,[l(q,{modelValue:!e.disabled,disabled:!0},null)])}}},{field:"is_admin",label:"最高权限",show:!0,slots:{default:a=>{const e=a.row;return l(b,null,[l(q,{modelValue:e.is_admin,disabled:!0},null)])}}},{field:"create_datetime",label:"创建时间",show:!0},{field:"action",width:"170px",label:"操作",show:!0,slots:{default:a=>{const e=a.row,n=["auth.role.update"],x=["auth.role.delete"];return l(b,null,[k(l(v,{type:"primary",link:!0,size:"small",onClick:()=>Z(e)},{default:()=>[g("编辑")]}),[[z,e.id!==1],[V("hasPermi"),n]]),k(l(v,{type:"primary",link:!0,size:"small",onClick:()=>Y(e)},{default:()=>[g("权限管理")]}),[[z,e.id!==1]]),k(l(v,{type:"danger",loading:P.value,link:!0,size:"small",onClick:()=>X(e)},{default:()=>[g("删除")]}),[[z,e.id!==1],[V("hasPermi"),x]])])}}}]),Q=U([{field:"name",label:"角色名称",component:"Input",componentProps:{clearable:!1,style:{width:"214px"}}},{field:"role_key",label:"权限字符",component:"Input",componentProps:{clearable:!1,style:{width:"214px"}}},{field:"disabled",label:"状态",component:"Select",componentProps:{style:{width:"214px"},options:[{label:"正常",value:!1},{label:"停用",value:!0}]}}]),E=r({}),O=a=>{c.value=1,E.value=a,w()},P=r(!1),X=a=>m(this,null,function*(){P.value=!0,yield H(!0,[a.id]).finally(()=>{P.value=!1})}),B=r(),Y=a=>m(this,null,function*(){var n;const e=yield W(a.id);e&&(e.data.data_range=e.data.data_range.toString(),h.value=e.data,(n=B.value)==null||n.openDrawer())}),p=r(!1),C=r(""),h=r(),S=r(""),M=r(),L=r(!1),Z=a=>m(this,null,function*(){const e=yield W(a.id);e&&(C.value="编辑角色",S.value="edit",e.data.data_range=e.data.data_range.toString(),h.value=e.data,p.value=!0)}),ee=()=>{C.value="新增角色",S.value="add",h.value=void 0,p.value=!0},ae=()=>m(this,null,function*(){const a=t(M),e=yield a==null?void 0:a.submit();if(e){L.value=!0;try{const n=r({});S.value==="add"?(n.value=yield ce(e),n.value&&(p.value=!1,w())):S.value==="edit"&&(n.value=yield me(e),n.value&&(p.value=!1,w()))}finally{L.value=!1}}});return(a,e)=>{const n=G("ElCol"),x=G("ElRow"),te=V("hasPermi");return N(),ie(b,null,[l(t(_e),null,{default:d(()=>[l(t(ve),{schema:Q,onReset:O,onSearch:O},null,8,["schema"]),l(t(fe),{"current-page":t(c),"onUpdate:currentPage":e[0]||(e[0]=f=>j(c)?c.value=f:null),"page-size":t(i),"onUpdate:pageSize":e[1]||(e[1]=f=>j(i)?i.value=f:null),showAction:"",columns:K,"default-expand-all":"","node-key":"id",data:t(A),loading:t(D),pagination:{total:t(_)},onRegister:t(o),onRefresh:t(w)},{toolbar:d(()=>[l(x,{gutter:10},{default:d(()=>[l(n,{span:1.5},{default:d(()=>[k((N(),re(t(v),{type:"primary",onClick:ee},{default:d(()=>[g("新增角色")]),_:1})),[[te,["auth.role.create"]]])]),_:1})]),_:1})]),_:1},8,["current-page","page-size","columns","data","loading","pagination","onRegister","onRefresh"])]),_:1}),l(t(be),{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=f=>p.value=f),title:C.value,height:650},{footer:d(()=>[l(t(v),{type:"primary",loading:L.value,onClick:ae},{default:d(()=>[g(J(t(s)("exampleDemo.save")),1)]),_:1},8,["loading"]),l(t(v),{onClick:e[2]||(e[2]=f=>p.value=!1)},{default:d(()=>[g(J(t(s)("dialogDemo.close")),1)]),_:1})]),default:d(()=>[l(we,{ref_key:"writeRef",ref:M,"current-row":h.value},null,8,["current-row"])]),_:1},8,["modelValue","title"]),l(he,{ref_key:"authManageRef",ref:B,"current-row":h.value,onGetList:t(w)},null,8,["current-row","onGetList"])],64)}}});export{qe as default};
//# sourceMappingURL=Role-DUV0wB4v.js.map
