var p=(b,m,s)=>new Promise((f,l)=>{var d=a=>{try{r(s.next(a))}catch(i){l(i)}},v=a=>{try{r(s.throw(a))}catch(i){l(i)}},r=a=>a.done?f(a.value):Promise.resolve(a.value).then(d,v);r((s=s.apply(b,m)).next())});import{u as k,F as C}from"./useForm-B2dmd6BN.js";import{u as A}from"./useValidator-B6tBWFkI.js";import{l as F,aB as x,J as B,O as w,V as D,P as R,a as y,m as V,S as E,R as S,u as _}from"./vue-chunks-DM5Q6aJS.js";import{_ as N}from"./ContentWrap.vue_vue_type_script_setup_true_lang-R-yJIw7t.js";import{a as O,b as q,p as M,c as T}from"./issue-CAO84TTy.js";import{t as $}from"./index-DY4Ks39X.js";import{b as t}from"./element-plus-D9n4Ar5m.js";import"./style.css_vue_type_style_index_0_src_true_lang-nZXfjKm1.js";import"./wang-editor-CLgHiBvf.js";const Y=F({name:"HelpIssueForm",__name:"Write",setup(b,{expose:m}){const{required:s}=A(),{push:f,currentRoute:l}=x(),d={customAlert:(e,o)=>{switch(o){case"success":t.success(e);break;case"info":t.info(e);break;case"warning":t.warning(e);break;case"error":t.error(e);break;default:t.info(e);break}},autoFocus:!1,scroll:!0,readOnly:!1,uploadImgShowBase64:!0,placeholder:"请输入内容..."},v=B([{field:"title",label:"标题名称",component:"Input",colProps:{span:24},componentProps:{style:{width:"100%"}},formItemProps:{rules:[s()]}},{field:"content",label:"内容",colProps:{span:24},component:"Editor",componentProps:{style:{width:"100%"},editorConfig:d,editorId:"issueContent"},formItemProps:{rules:[s()]}},{field:"category_id",label:"问题类别",colProps:{span:24},component:"Select",componentProps:{style:{width:"100%"}},formItemProps:{rules:[s()]},optionApi:()=>p(this,null,function*(){return(yield O()).data})},{field:"",label:"",colProps:{span:24},formItemProps:{slots:{default:()=>w(R,null,[w($,{loading:c.value,type:"primary",onClick:I},{default:()=>[D("立即保存")]})])}}}]),{formRegister:r,formMethods:a}=k(),{getFormData:i,getElFormExpose:P,setValues:h}=a,u=y(""),c=y(!1);p(this,null,function*(){const e=l.value.query.id;if(e){u.value="edit";const o=yield T(Number(e));o?h(o.data):f("/404")}else u.value="add"});const I=()=>p(this,null,function*(){const e=yield P();if(yield e==null?void 0:e.validate()){c.value=!0;const g=yield i();if(!g)return c.value=!1,t.error("未获取到数据");const n=y();try{u.value==="add"?(n.value=yield q(g),n.value&&(e==null||e.resetFields(),t.success("新增成功"))):u.value==="edit"&&(n.value=yield M(g),n.value&&(h(n.value.data),t.success("更新成功")))}finally{c.value=!1}}});return m({submit:I}),(e,o)=>(V(),E(_(N),null,{default:S(()=>[w(_(C),{onRegister:_(r),schema:v,labelPosition:"top"},null,8,["onRegister","schema"])]),_:1}))}});export{Y as default};
//# sourceMappingURL=Write-g5jTQCVj.js.map
